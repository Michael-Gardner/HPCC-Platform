[Unit]
Description=%i
After=network.target remote-fs.target hpcc-conf@%i.service dafilesrv.service
Requires=hpcc-conf@%i.service

[Service]
Type=forking
User=@RUNTIME_USER@
Group=@RUNTIME_GROUP@
PermissionsStartOnly=false
WorkingDirectory=@RUNTIME_PATH@/%i
EnvironmentFile=@RUNTIME_PATH@/%i/%i.cfg
PIDFile=@PID_PATH@/%i.pid
@spark_master_start@
ExecStart=@EXEC_PATH@/esp --daemon %i
Restart=on-failure
RestartSec=5
TimeoutSec=30
@spark_master_stop@
LimitCORE=infinity
LimitNPROC=4096:8192
LimitNOFILE=8192:32768
LimitRTPRIO=0:4
LimitMEMLOCK=infinity

[Install]
DefaultInstance=myesp
